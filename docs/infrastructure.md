# Udacity Full Stack javascript developer - Hosting a Full-Stack Application - Infrastructure description

## AWS Resources used

The infrastructure uses different AWS Services:
  * Amazon Relational Database Services (RDS) for a Postgres database
  * Elastic Beanstalk (EB) to host the backend API, and S3 to store media (i.e. images)
  * S3 for static hosting of the frontend files

All AWS resources used are hosted in the the EU (Frankfurt) region.

## RDS

The RDS Postgres database is called `database-udagram` and its endpoint is https://database-udagram.cocna09lelvj.eu-central-1.rds.amazonaws.com.
It has a dedicated security group `udagram-security-group` that allows all incoming traffic on port 5432.

Master username for the database is `postgres` and the password was generated by AWS and storend in an environment variable.

Here is a snapshot showing the RDS service that was set up:
![alt text](https://github.com/PaulPloumhans/fullstack-app-deployment/blob/master/docs/RDS_service.png "RDS set up")

## Elastic Bean Stalk instance for API hosting

The node.js server on EB runs on port 8080. However, it has to be access from outside of the amazon instance through port 80 at the address http://udagram-api.eba-i4iqqfaw.eu-central-1.elasticbeanstalk.com/api/v0.

Here is a snapshot showing the RDS service that was set up:
![alt text](https://github.com/PaulPloumhans/fullstack-app-deployment/blob/master/docs/EBS_service.png "EBS set up")

## S3 bucket for API media storing

The `udagram-api-media` bucket is used to store media by the API. For access management purposes, it has a dedicated admin user called `udagram-api-media` with associated access keys. Moreover, the bucket has the following CORS policy:
```
[
    {
        "AllowedHeaders": [
            "*"
        ],
        "AllowedMethods": [
            "PUT",
            "POST",
            "DELETE",
            "HEAD",
            "GET"
        ],
        "AllowedOrigins": [
            "*"
        ],
        "ExposeHeaders": []
    }
]
```

Its bucket policy is
```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadGetObject",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::udagram-api-media/*"
        }
    ]
}
```

Here is a snapshot showing all the S3 services that were set up (`udagram-api-media` is the relevant one):
![alt text](https://github.com/PaulPloumhans/fullstack-app-deployment/blob/master/docs/S3_service.png "S3 set up")

## S3 bucket for website static hosting

The S3 endpoint for website static hosting http://udagram-ppl.s3-website.eu-central-1.amazonaws.com/. Its bucket policy is:
```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicRead",
            "Effect": "Allow",
            "Principal": "*",
            "Action": [
                "s3:GetObject",
                "s3:GetObjectVersion"
            ],
            "Resource": "arn:aws:s3:::udagram-ppl/*"
        }
    ]
}
```

Here is a snapshot showing all the S3 services that were set up (`udagram-ppl` is the relevant one):
![alt text](https://github.com/PaulPloumhans/fullstack-app-deployment/blob/master/docs/S3_service.png "S3 set up")
